Microsoft Corp surpassed Apple Inc to become the world’s most valuable publicly traded company. All it took was a $300 billion rout. After briefly claiming the top spot on Monday, Microsoft shares rose 0.6% Tuesday, pushing the company’s market value to $828.1 billion at the close. That exceeded by more than $1 billion the value of Apple, which has tumbled this month on concern about iPhone unit sales. The last time Microsoft’s market capitalization was bigger than Apple was in 2010, according to data compiled by Bloomberg. A recent stock market swoon has taken a toll on nearly all technology companies. But investors have punished consumer-focused companies like Apple and Amazon.com Inc. more than firms that mostly cater to businesses, like Microsoft. It’s down 6.3% since the start of October, while Apple has lost 23%. Starting more than a decade ago, Microsoft fell behind Apple as computing shifted from desktop machines to mobile devices like iPhones, making Microsoft’s PC dominance less relevant. Attempts to regain its footing by acquiring Nokia’s handset business and releasing its own phones led to expensive writedowns. This was particularly galling for the Redmond, Washington-based company because it once kept Apple afloat with a cash infusion in the 1990s. The rise of cloud computing changed Microsoft’s fortunes about five years ago. Under Chief Executive Officer Satya Nadella, the company invested heavily in data centers and other infrastructure to run applications and store data for corporate customers. And instead of trying to tie Office work productivity software to its Windows operating system, Microsoft offered it as a subscription service over the internet and on other companies’ devices – including Apple’s. It also stopped making smartphone hardware, while boosting the quality of its tablet and PC designs. Microsoft is now second behind Amazon Web Services in the cloud. That’s insulated Microsoft’s stock from worries about declining consumer spending on devices and increased regulation of digital advertising businesses like Facebook Inc. and Alphabet Inc’s Google.  Read: Trump suggests Apple iPhones may get hit with 10% tariff